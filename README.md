
# # 📘 《謝爾夏》遊戲計畫書

# ---

# # 1. 遊戲總覽（Overview）

《謝爾夏》是一款 **多人同步、回合戰鬥、PC/網頁/Discord 皆可遊玩**的戰鬥遊戲。
玩家控制自己的角色，使用技能、移動、支援隊友，透過策略與反應擊敗對手。

遊戲特色：

* 多角色、多職業、可自由創角
* 每場戰鬥包含 **行動 → 閃避 → 支援 → 技能介入 → 傷害結算**
* 遊戲邏輯統一，由 **Cocos（或 Web）＋ Edge Functions** 完成
* 角色資料存於「角色資料庫」
* 背包、攜帶物存於「Bot 資料庫」
* 本場戰鬥快照存於「Battle 戰鬥資料庫」
* Discord 可遊玩（Activities）
* PC/手機可用 Web 直接遊玩

---

# # 2. 戰鬥結構（Battle Structure）

## 2.1 場上區域

* A 區
* B 區
* C 區

所有戰鬥邏輯依三區系統運作（技能範圍、支援判定、移動判定都依此）。

---

# # 3. 角色行動順序（Flow）

## **整體流程圖（高階版）**

```
行動 → 攻擊/技能/CC → 閃避CC  → 技能（再來一次？） → 技能（修但幾咧？）/技能 （害人放空大？）→ 技能（哩嘎挖但咧？）→ 支援CC
→ 傷害結算 → HP 更新 → 回合結束判定
```

下面會用完整文字寫出每個階段的邏輯。

---

# # 4. 行動流程（詳細）

## 4.1 行動點數（Action Point）

* 每回合所有角色都有 **1 行動點**
* 玩家點按「行動」→ 消耗行動點 → 角色進入行動序列（排隊）

### * 特殊職位 專補
專補進入行動續列為 "插隊" 
必定在現在行動者的下一個順位行動




---

## 4.2 輪到你時可做的事

* 移動（不結束行動）
* 攻擊（結束行動）
* 使用技能（結束行動）
* 主動 PASS（結束行動）

---

## 4.3 移動

* 玩家可移動到另一區
* 移動不會結束行動
* 若是跨區支援（移動＋掩護 / 移動＋擋刀） → 會消耗行動點並進入移動CD

---

# # 5. 攻擊流程（最重要）

## **Step 1｜攻擊 CC 判定**

攻擊需骰 CC

* 成功 → 進入受擊者「閃避階段」
* 失敗 → 啟動 **增益職（再來一次技能）是否介入**

---

## **Step 2｜閃避階段（Dodge Phase）**

受擊者會看到「閃避」按鈕（30 秒）

* 閃避成功 → 本次攻擊完全無效
* 閃避失敗或未按 → 進入支援階段

---


# # 6. 技能介入系統（非常重要）

在支援前、中、後，有三大職業技能可能介入：

---

## ⭐ **1. 增益職：再來一次**

觸發條件：

* 普通攻擊 **CC 失敗**

流程：

1. 系統詢問有該技能且有行動點的增益職是否啟動
2. 對方需在 3 秒內按下
3. 攻擊者重新骰一次 CC
4. 新結果覆蓋舊結果

---

## ⭐ **2. 妨礙職：修但幾咧	**

觸發條件：

* 攻擊者 CC 成功
* 防守者閃避失敗

流程：

1. 有該技能且有行動點的妨礙職被詢問是否要啟動（3 秒）
2. 攻擊者需骰 CC45
3. 失敗 → 攻擊取消、傷害歸零、行動點返還(視同沒有這回合)
4. 成功 → 進入下一技能「哩嘎挖但咧」判定


## ⭐ **2-2. 妨礙職：害人放空大	**

* 當敵方
1 敵方對敵方的隊友使出補師/增益技能時
2 敵方對我方使出 攻擊/妨礙 技能 時

將該技能的目標更改為空氣

* 假如是 自身+血 搭配敵方損血，會變成只有自身+血 

---

## ⭐ **3. 坦職：哩嘎挖但咧	（Taunt）** 

觸發條件：

* 修但幾咧 被閃避成功 → 跳到此
* 或沒有妨礙 → 直接詢問坦

流程：

1. 有該技能且有行動點的坦被詢問是否開技能（3 秒） 
2. 攻擊者要骰 CC45 躲避 "哩嘎挖但咧	" 
3. 若失敗 → 本次攻擊 → 導向坦（坦不能被支援、坦不能c閃避） 
4. 若成功 → 回到支援流程（原攻擊對象）

---


# # 7. 支援系統（Support System）

支援只會對「閃避失敗者」啟動。

## 可支援的人：

* 同區（掩護 / 擋刀 / 補擋）
* 跨區並有行動點可消耗（移動掩護 / 移動擋刀/遠攻專用遠距離掩護） 

---

## 支援種類 先詢問技能後詢問非技能

### 🛡 **1) 掩護（Cover）**

* 同區
* CC45
* 成功：雙方無傷
* 失敗：受擊者受原傷，掩護者受 1 傷
* 可進入補擋

---

### 🗡 **2) 擋刀（Guard）**

* 同區
* CC45
* 成功：全部傷害由支援者承擔
* 失敗：兩人平分傷害

---

### 💨 **3) 遠距離掩護（Ranged Cover）**

* 遠攻角色
* 不可轉擋刀
* 成功：受擊者無傷
* 失敗：受擊者受原傷
* 大成功：攻擊者反受 1 傷
* 大失敗：受擊者受原傷+1 傷

---

### 🪓 **4) 補擋（Back-up Guard）**

* 掩護失敗後才可使用
* CC45
* 成功：補擋者承傷；隊友無傷
* 失敗：兩人平分傷害

---
	

# # 8. 範圍盾系統

三種盾（坦技能）：

## **近攻範圍盾**

* 近戰攻擊 → 盾判定
* 遠攻攻擊 → 被攻擊者照常閃避，盾直接破

## **遠攻範圍盾**

* 遠攻 → 盾判定
* 近攻 → 被攻擊者照常閃避，盾直接破

## **絕對範圍盾**

* 全部攻擊都視為打盾
* 不能略過
* 盾破則保護者無傷

多盾時：

1. 絕對盾優先
2. 再比範圍
3. 無法支援的攻擊類型直接破盾

---

# # 9. 補位系統（盾補位）

當盾主離開 → 坦跳出「補位」按鈕。

* 補位不消耗行動點
* 補位會進到行動序列最上方
* 多人補位依按鈕順序排

---

# # 10. 回合結束

以下任一觸發回合結束：

* 所有人行動點為 0
* 行動序列清空

下一回合 → 行動點回復 1

---





---
# # 11. 資料庫架構（小學生能懂版）

你有 **3 個資料庫**：

---

## **✨ 1. Core 角色資料庫（角色的「身分證」）**

放的東西像：

* 這個角色叫什麼名字
* 他有什麼技能
* 他是什麼職業
* 技能效果有什麼
* 技能CD多少
* 技能強度多少

> **這裡的資料是永遠不會改的。**
> 角色進戰鬥前從這裡「讀一次」，這叫「快照」。

---

## **✨ 2. Bot 資料庫（背包倉庫）**

放：

* 角色的背包
* 攜帶物 4 格
* 消耗品剩多少次
* DCID 與 player_id 的對應

戰鬥開始 → 把這些資料複製一份到 Battle DB
戰鬥結束 → 覆蓋回來

---

## **✨ 3. Battle 戰鬥資料庫（遊戲專用）**

這裡像是一張「白紙」：

* 戰鬥角色快照（HP、CD、技能CD、行動序列）
* 攜帶物快照（只用這份）
* 行動紀錄
* login_cache（誰能登入、誰有控制權）

戰鬥結束 →
👉 全部刪掉
👉 寫入戰報表

---

# # 12. 遊戲登入流程

## Discord 玩

1. Discord SDK 取得 DCID
2. Edge → 用 DCID 查 login_cache
3. 有 → 進遊戲
4. 無 → 顯示「未授權，請聯繫管理員」

## Web 玩

1. Discord OAuth Provider 取得 DCID
2. Edge 查 login_cache
3. 有 → 進遊戲
4. 無 → 登出 & 顯示未授權

---

# # 13. 遊戲結束流程

1. Edge 計算勝負
2. 從 Battle DB → 取：

   * 攜帶物使用後剩餘量
   * 消耗品剩餘數
3. 覆蓋回 Bot DB（你規定輸的人若戰中去買東西 → 視為損失）
4. 寫戰報
5. 清空整個房間所有資料

---

# # 14. 多載具同步（DC + Web）

* Discord 端用 Activity
* Web 端用瀏覽器
* Edge → 統一管資料
* Cocos → 前端畫面與數據判定
* Battle DB → 即時狀態
* 任何端都可以控制，只要 login_cache 檢查通過

---
